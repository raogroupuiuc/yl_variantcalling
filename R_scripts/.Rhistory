' Analysis of actual data
Started March 4, 2021 from workshop practised code
used for Xylose mutants
Step 2- analyse the imported vcf files '
getwd()
setwd("D:/Box Sync/02 - RNA seq work/2101-YL-Evolution (Sangdo)/R analysis/")
library(GenomicRanges)
library(GenomicFeatures)
library(Biostrings)
library(Rsamtools)
library(SummarizedExperiment)
library(magrittr)
library(VariantAnnotation)
library(snpStats)
library(ggplot2)
library(scater)
rm(list = ls())
load("01_dataimport.Rdata")
setwd("D:/Box Sync/02 - RNA seq work/2101-YL-Evolution (Sangdo)/Git_shared/yl_variantcalling/R_scripts/")
load("01_dataimport.Rdata")
head(rowRanges(readvcf.plasmid))
head(info(readvcf.plasmid))
colnames(info(readvcf.plasmid))
info(readvcf.plasmid)$DP # use this to make histograms
geno(readvcf.plasmid)
head(geno(readvcf.plasmid)$DP)
head(rowRanges(readvcf.strains))
head(info(readvcf.strains))
colnames(info(readvcf.strains))
head(rowRanges(readvcf.strains))
head(info(readvcf.strains))
colnames(info(readvcf.strains))
info(readvcf.strains)$DP # use this to make histograms
geno(readvcf.strains)
head(geno(readvcf.strains)$DP)
write.table(geno(readvcf.plasmid)$DP, "results/readdepth-plasmid.txt", sep = "\t")
write.table(geno(readvcf.strains)$DP, "results/readdepth-strains.txt", sep = "\t")
write.table(geno(readvcf.plasmid)$GT, "results/mutations-plasmid.txt", sep = "\t")
write.table(geno(readvcf.strains)$GT, "results/mutations-strains.txt", sep = "\t")
sig.hits.plasmid <- rowRanges(readvcf.plasmid)
sig.hits.strains <- rowRanges(readvcf.strains)
my_ld <- 1000
search.plasmid <- flank(sig.hits.plasmid, my_ld, both = TRUE)
search.strains <- flank(sig.hits.strains, my_ld, both = TRUE)
hits.plasmid <- findOverlaps(search.plasmid, gtf.gene.plasmid)
hits.plasmid2 <- data.frame(SNP = names(search.plasmid)[queryHits(hits.plasmid)],
Gene = gtf.gene.plasmid$ID[subjectHits(hits.plasmid)])
hits.plasmid3 <- findOverlaps(sig.hits.plasmid, gtf.gene.plasmid)
hits.plasmid4 <- data.frame(SNP = names(search.plasmid)[queryHits(hits.plasmid3)],
Gene = gtf.gene.plasmid$ID[subjectHits(hits.plasmid3)])
hits.plasmid4
hits.strains <- findOverlaps(search.strains, gtf.gene.strains)
hits.strains2 <- data.frame(SNP = names(search.strains)[queryHits(hits.strains)],
Gene = gtf.gene.strains$ID[subjectHits(hits.strains)])
hits.strains3 <- findOverlaps(sig.hits.strains, gtf.gene.strains)
hits.strains4 <- data.frame(SNP = names(search.strains)[queryHits(hits.strains3)],
Gene = gtf.gene.strains$ID[subjectHits(hits.strains3)])
hits.strains4
write.table(hits.plasmid4, "results/snpsingene-annotated-plasmid.txt", sep = "\t")
write.table(hits.strains4, "results/snpsingene-annotated-strains.txt", sep = "\t")
save.image("02-analysis-part1.Rdata")
sessionInfo()
